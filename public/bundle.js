(()=>{"use strict";var t={d:(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function n(t,e){let n=t.createShader(t.VERTEX_SHADER),r=t.createShader(t.FRAGMENT_SHADER);if(t.shaderSource(n,e.vs),t.shaderSource(r,e.fs),t.compileShader(r),t.compileShader(n),![n,r].every(((e,n)=>!!t.getShaderParameter(e,t.COMPILE_STATUS)||(console.log("error compiling",n?"fragment":"vertex","shader:"),console.log(t.getShaderInfoLog(e)),t.deleteShader(e),!1))))return null;let i=t.createProgram();return t.attachShader(i,n),t.attachShader(i,r),t.linkProgram(i),e.shaderProgram=i,e.uniformSetters=function(t,e){let n={},r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<r;i++){let r=t.getActiveUniform(e,i),o=t.getUniformLocation(e,r.name);n[r.name.replace("[0]","")]=s(t,r.type,r.size,o)}return n}(t,i),function(t,e){for(let n in e.arrays)e.arrays[n].location=t.getAttribLocation(e.shaderProgram,n);"string"==typeof e.drawMode?e.drawMode=t[e.drawMode]:"number"!=typeof e.drawMode&&(e.drawMode=t.TRIANGLES)}(t,e),1}function r(t,e,n){let r=n||e.arrays;for(let n in r){let i=r[n];if(i.location<0)continue;let o="string"==typeof i.data;if(o?i.buffer=r[i.data].buffer:i.buffer||(i.buffer=t.createBuffer()),"position"!=n||e.vao||(e.vao=t.createVertexArray(),t.bindVertexArray(e.vao)),"indices"==n)t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i.buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(i.data),t.STATIC_DRAW);else{t.bindBuffer(t.ARRAY_BUFFER,i.buffer),o||t.bufferData(t.ARRAY_BUFFER,new Float32Array(i.data),t.STATIC_DRAW);let e=i.stride||0,n=i.offset||0;t.vertexAttribPointer(i.location,i.components,t.FLOAT,0,4*e,4*n),t.enableVertexAttribArray(i.location)}}t.bindVertexArray(null),function(t){if(t.arrays.position){let e=t.arrays.indices?t.arrays.indices.data.length:t.arrays.position.data.length/(t.arrays.position.stride||t.arrays.position.components);t.count=e}}(e)}function i(t,e){if(e.vao)t.bindVertexArray(e.vao);else for(let n in e.arrays){let r=e.arrays[n];if("indices"===n)t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.buffer);else{t.bindBuffer(t.ARRAY_BUFFER,r.buffer);let e=r.stride||0,n=r.offset||0;t.vertexAttribPointer(r.location,r.components,t.FLOAT,0,4*e,4*n),t.enableVertexAttribArray(r.location)}}t.useProgram(e.shaderProgram)}function o(t,e){for(let n in e.uniforms)e.uniformSetters[n]&&e.uniformSetters[n](t,e.uniforms[n])}function a(t,e){e.arrays.indices?t.drawElements(e.drawMode,e.count,t.UNSIGNED_SHORT,0):t.drawArrays(e.drawMode,0,e.count)}function s(t,e,n,r){let i=n>1;switch(e){case t.FLOAT:return i?(t,e)=>{t.uniform1fv(r,e)}:(t,e)=>{t.uniform1f(r,e)};case t.FLOAT_VEC2:return i?(t,e)=>{t.uniform2fv(r,e)}:(t,e)=>{t.uniform2f(r,...e)};case t.FLOAT_VEC3:return i?(t,e)=>{t.uniform3fv(r,e)}:(t,e)=>{t.uniform3f(r,...e)};case t.FLOAT_VEC4:return i?(t,e)=>{t.uniform4fv(r,e)}:(t,e)=>{t.uniform4f(r,...e)};case t.FLOAT_MAT2:return(t,e)=>{t.uniformMatrix2fv(r,!1,e)};case t.FLOAT_MAT3:return(t,e)=>{t.uniformMatrix3fv(r,!1,e)};case t.FLOAT_MAT4:return(t,e)=>{t.uniformMatrix4fv(r,!1,e)};case t.SAMPLER_2D:case t.SAMPLER_3D:case t.SAMPLER_2D_ARRAY:case t.SAMPLER_CUBE:case t.BOOL:case t.INT:return i?(t,e)=>{t.uniform1iv(r,e)}:(t,e)=>{t.uniform1i(r,e)};case t.INT_VEC2:return i?(t,e)=>{t.uniform2iv(r,e)}:(t,e)=>{t.uniform2i(r,...e)};case t.INT_VEC3:return i?(t,e)=>{t.uniform3iv(r,e)}:(t,e)=>{t.uniform3i(r,...e)};case t.INT_VEC4:return i?(t,e)=>{t.uniform4iv(r,e)}:(t,e)=>{t.uniform4i(r,...e)}}}t.r(e),t.d(e,{createShaderProgram:()=>n,drawObj:()=>a,enableAttributes:()=>i,setBuffers:()=>r,setUniforms:()=>o});const l={arrays:{position:{components:3,data:[-1,-1,0,1,-1,0,-1,1,0,1,1,0]},color:{components:3,data:[0,1,0,0,0,1,0,0,1,1,0,0]}},clearcolor:[0,0,0,0],uniforms:{resolution:[500,500],mouse:[0,0],time:0},vs:"#version 300 es\n\tin vec3 position;\n\tin vec3 color;\n\tout vec3 vcolor;\n    \n    void main() {\n    \tvcolor = color;\n        gl_Position = vec4(position, 1.);\n    }\n",fs:"#version 300 es\n    precision mediump float;\n    in vec3 vcolor;\n    out vec4 fragColor;\n    uniform vec2 resolution;\n    uniform vec2 mouse;\n    uniform float time;\n    #define res resolution\n\n    void main(){\n    \t// fragColor = vec4(((2.*gl_FragCoord.xy-res)/res).xyx*cos(time+vec3(0,1,3))*.5+.5, 1);\n        fragColor = vec4(0,0,0,1);\n    }\n",drawMode:"TRIANGLE_STRIP",textures:null,rendercb:()=>{},setupcb:()=>{},chain:[],shaderProgram:null,on:!0};function h(t,e,n){n&&(e.ctl=n);for(let n in e)null==t[n]&&(t[n]=e[n])}function u(t,e,n,r){if(e._gui=t.addFolder(e.gui.name||""),r&&e._gui.hide(),e.gui.open&&e.on&&e._gui.open(),e.ctl=n,c(e._gui,e.gui,n),e._gui.title=e._gui.__ul.firstChild,e._gui.title.style.color=e.on?"springgreen":"white",e.gui.switch){e._gui.add({"":e.on},"",e.on).onChange((t=>{e.on=t,e._gui.title.style.color=e.on?"springgreen":"white",n.frame()}))}}function f(t,e,n){let r=t.addFolder(e.name||"");e.open&&r.open(),c(r,e,n),r.title=r.__ul.firstChild,r.title.style.color="springgreen"}function c(t,e,n){let r=0;for(let i of e.fields||[]){if(i.fields){f(t,i,n);continue}let o;(o=i.onChange)&&delete i.onChange,i=F(i);let a=[i,Object.keys(i)[0],...Object.values(i).slice(1)],s=t.add(...a);o&&(e.updateFrame?s.onChange((t=>{o(t),n.frame()})):s.onChange(o)),e.fields[r++].ref=s}e.ctl=n}function F(t){let e=Object.entries(t)[0];return e[1]instanceof Array&&(t[e[0]]=e[1][0],t.min=e[1][1],t.max=e[1][2],t.step=e[1][3]),t}const m=class{constructor(t,n,r,i,o,a,s,l){if(this.pgms=n instanceof Array?n:[n],this.prog=this.pgms[0],this.gl=t.getContext("webgl2",{premultipliedAlpha:!0,antialias:!0}),!this.gl)return void console.log("no gl context");this.res=r||[500,500],function(t,e){t.width=e[0],t.height=e[1],t.style.width=e[0]+"px",t.style.height=e[1]+"px"}(t,this.res),this.render=this.render.bind(this),this.fpsloop=this.fpsloop.bind(this),this.req=null,this.loop=!1,this.mgl=e,this.ms=i?1e3/i:0,this.mouse=[0,0],this.time=0,t.onmousemove=t=>{this.mouse[0]=t.offsetX/this.res[0],this.mouse[1]=1-t.offsetY/this.res[1]},this.gl.disable(this.gl.DEPTH_TEST),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.viewport(0,0,this.res[0],this.res[1]),this.params=l;let h=()=>{};this.cbobj=s||{init:h,start:h,stop:h,frame:h,pgms:[],params:[]},s.init(this),this.init(this.gl,this.pgms)?(o&&function(t,e,n){t.__closeButton.style.visibility="hidden",e.pgms.length>1&&t.add({pgm:0},"pgm",0,e.pgms.length-1,1).onChange((t=>{e.switchProgram(t)}));n&&(n.name?f(t,n,e):c(t,n,e));for(let n of e.pgms){n.gui&&u(t,n,e,n!==e.prog);for(let r of n.chain||[])r.gui&&u(t,r,e)}for(let n of e.cbobj.pgms)n.gui&&u(t,n,e)}(o,this,a),this.gl.clearColor(...this.prog.clearcolor)):this.start=this.frame=()=>{}}start(){if(this.loop)return;this.loop=!0;const t=e=>{this.render(e),this.req=requestAnimationFrame(t)};this.ms?this.fpsloop(this.ms):t(0),this.cbobj.start()}stop(){this.loop=!1,cancelAnimationFrame(this.req),this.cbobj.stop()}switchProgram(t){this.pgms[t]&&(this.prog._gui&&this.prog._gui.hide(),this.prog=this.pgms[t],this.gl.clearColor(...this.prog.clearcolor),this.frame(),this.prog._gui&&this.prog._gui.show())}frame(t=0){this.loop||this.render(t),this.cbobj.frame(t)}render(t){this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.prog.uniforms.time=.001*t,this.prog.uniforms.mouse=this.mouse,i(this.gl,this.prog),this.prog.rendercb(this.prog),o(this.gl,this.prog),this.prog.draw(this.prog);for(let e of this.prog.chain)e.on&&(e.uniforms.time=.01*t,e.uniforms.mouse=this.mouse,i(this.gl,e),e.rendercb(e),o(this.gl,e),a(this.gl,e))}fpsloop(t){let e=performance.now();const n=r=>{this.req=requestAnimationFrame(n);let i=r-e;i>t&&(e=r-i%t,this.render(r))};n(0)}init(t,e){for(let i of e){if(h(i,l,this),i.uniforms.resolution=this.res,i.uniforms.time=0,!n(t,i))return null;i.setupcb(i),i.draw||(i.draw=()=>{a(this.gl,i)}),r(t,i);for(let e of i.chain||[]){if(h(e,{...l,count:i.count}),e.uniforms.resolution=this.res,e.uniforms.time=0,!n(t,e))return null;e.setupcb(e),r(t,e)}}return 1}};function d(t,e,n,r){let i=function(t,e,n){let r=e*Math.min(n,1-n),i=(e,i=(e+t/30)%12)=>n-r*Math.max(Math.min(i-3,9-i,1),-1);return[i(0),i(8),i(4)]}(360*t,e,n);return`rgba(${255*i[0]}, ${255*i[1]}, ${255*i[2]}, ${r})`}const p=class{constructor(t,e,n=[500,500],r){t?(t.width=n[0],t.height=n[1],this.w=n[0],this.h=n[1],this.canvas=t,this.mouse=[0,0],this.canvas.onmousemove=t=>{this.mouse[0]=t.offsetX/this.w,this.mouse[1]=1-t.offsetY/this.h},this.ctx=t.getContext("2d"),this.pgms=e instanceof Array?e:[e],this.loop=this.loop.bind(this),this.running=!1,this.fill=this.canvas.style.backgroundColor,this.stroke="#000000"):console.log("null canvas")}init(t){this.params=t.params,this.ctl=t;for(let t of this.pgms)t.setup(this),t.on=null==t.on||t.on}start(){this.running=!0,this.loopid=requestAnimationFrame(this.loop)}stop(){this.running=!1,cancelAnimationFrame(this.loopid);for(let t of this.pgms)t.on&&t.unloop&&t.unloop();this.frame()}loop(t){this.ctx.clearRect(0,0,this.w,this.h),this.params=this.ctl.params;for(let e of this.pgms)e.on&&e.loop&&e.loop(t,this);this.running&&(this.loopid=requestAnimationFrame(this.loop))}draw(){this.params=this.ctl.params,this.ctx.clearRect(0,0,this.w,this.h);for(let t of this.pgms)t.on&&t.draw(this)}frame(){this.draw(this)}lineWidth(t){this.ctx.lineWidth=t}setStroke(t=0,e=0,n=0,r=1){this.ctx.strokeStyle="string"==typeof t?t:d(t,e,n,r)}setBkgd(t=0,e=0,n=0,r=1){this.canvas.style.backgroundColor="string"==typeof t?t:d(t,e,n,r)}canvasStyle(t){for(let e in t||{})this.canvas.style[e]=t[e]}};function v(t,e,n){let r=(r,i=(r+6*t)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}var g=[.75,1,.6],w=v(...g);const y={fs:"#version 300 es\n    precision mediump float;\n    out vec4 fragColor;\n    uniform vec2 resolution;\n    uniform float time;\n    #define glf gl_FragCoord\n\t#define PI 3.14159265\n\t#define _b 1.6\n\tuniform vec3 col;\n\tuniform float alpha;\n\n\tvec2 b(float t, vec2 v){\n\t   return abs(fract(t*v)-.5)*2.;\n\t}\n\n\tfloat ff(float n, float n2, float n3, float amp){\n \t\treturn ((sin(n)+1.)*(sin(n2)*(sin(n3))+1.)+log(((sin(PI+n)+1.)*(sin(PI+n2)+1.))+1.))*amp; \n\t}\n\n\tvoid main(){\n\t    vec2 uv = glf.xy/resolution.xy;\n\t    \n\t    float a = 10.;\n\t    float amp = 0.5;\n\t    float d = .2;\n\t    \n\t    float t = 3.+time*0.001;\n\n\t    float n = a*(t+distance(uv, _b*b(t,vec2(3.1,1.7))));\n\t    float n2 = a*(t+distance(uv, _b*b(t,vec2(2.4,3.15))));\n\t    float n3 = a*(t+distance(uv, _b*b(t,vec2(1.45,2.65))));\n\t    \n\t    float f = ff(n, n2, n3, amp);\n\t    float f2 = ff(n+d, n2+d, n3+d, amp);\n\t    \n\t    n = a*(t+distance(uv, b(t,vec2(1.5,3.7))));\n\t    n2 = a*(t+distance(uv, b(t,vec2(3.4,1.15))));\n\t    n3 = a*(t+distance(uv, b(t,vec2(2.45,1.65))));\n\t    \n\t    f += ff(n, n2, n3, amp);\n\t    f2 += ff(n+d, n2+d, n3+d, amp);\n\t    \n\t    float v = (f2-f)/d;\n\t    float fade = min(.2, max(alpha, .01))*5.;\n\t    float alpha = smoothstep(clamp(v*fade, -2., 0.), .6, alpha*.6);\n\t    fragColor = vec4(col, alpha);\n\t}\n\n",gui:{name:"wave",open:!1,switch:!0,updateFrame:!0,fields:[{h:[g[0],0,1,.1],onChange:t=>{g[0]=t,y.uniforms.col=v(...g)}},{s:[g[1],0,1,.1],onChange:t=>{g[1]=t,y.uniforms.col=v(...g)}},{v:[g[2],0,1,.1],onChange:t=>{g[2]=t,y.uniforms.col=v(...g)}},{alpha:[.04,0,.5,.01],onChange:t=>{y.uniforms.alpha=t}}]},uniforms:{col:w,alpha:.04}},X=y;function M(t,e,n){let r=(r,i=(r+6*t)%6)=>n-n*e*Math.max(Math.min(i,4-i,1),0);return[r(5),r(3),r(1)]}const x={fs:"#version 300 es\n    precision mediump float;\n    out vec4 fragColor;\n    uniform vec2 resolution;\n    uniform vec2 vmouse;\n    uniform float alpha;\n    uniform float time;\n    uniform float tscale;\n    uniform float amp;\n    uniform vec3 c1; // specular color\n    uniform vec3 c2; // diffuse color\n\n    vec2 ball(float t){\n        return vec2(sin(t*1.2)*cos(5.+t*.82), cos(6.+t*.9));\n    }\n\n    vec2 pw(float i, vec2 uv, vec2 d, float t, float a){\n        t *= .4;\n        a*=1.5;\n        i = (1.+i)*5000.;\n        d += ball(i*9.+t*.0)*.6;\n        float m =  mix(.1, 1., sin(i)*.5+.5);\n        t *= 5.+a*.4;\n        a = mix(a*.1, a*1.5, sin(i)*.5+.5);\n        float dx = m*d.x*cos(length(d)*a+t+a);\n        float dy = m*d.y*cos(length(d)*a+t+a);\n        return vec2(dx, dy);\n    }\n\n    vec3 wave(vec2 uv, vec2 d, float t, float a){\n        vec2 p = pw(0., uv, d, t, a) +\n        pw(1., uv, d, t, a) +\n        pw(2., uv, d, t, a) +\n        pw(3., uv, d, t, a);\n        return normalize(cross(vec3(1, 0, p.x), vec3(0, 1, p.y)));\n    }\n\n    vec3 light(vec2 uv, float t, float a){\n        vec3 l1 = normalize(vec3(vmouse*2.-1., 1));\n        vec3 l2 = normalize(vec3(-1., -1.5, 2.5));\n        vec3 w = wave(uv, uv, t, a);\n        float ld = clamp(dot(l1, w),0.,1.);\n        float lf = clamp(pow(.5-dot(l2, w),5.),0.,1.);\n        float ls = clamp(pow(dot(l1, w),90.),0.,1.);\n        float ls2 = clamp(pow(dot(l2, w),55.),0.,1.);\n        vec3 l = .2*c2+c1*.6*ld + c1*.7*ls +.4*ls2*c2 +lf*c1*.2;\n        return l;\n    }\n\n    void main(){\n        vec2 uv = (2.*gl_FragCoord.xy-resolution)/resolution;\n        vec3 l = light(uv, time*-.1*tscale, amp);\n        fragColor = vec4(l, smoothstep( dot(l.xyz,vec3(.4)), 0., alpha) );\n    }\n",uniforms:{vmouse:[.2,.5],amp:3.7,tscale:.18,alpha:.36,c1:M(.77,.8,1),c2:M(.66,.9,1)},gui:{name:"waveb",open:!1,switch:!0,updateFrame:!0,fields:[{lightx:[.2,0,1,.1],onChange:t=>{x.uniforms.vmouse[0]=t}},{lighty:[.5,0,1,.1],onChange:t=>{x.uniforms.vmouse[1]=t}},{spec_hue:[.77,0,1,.01],onChange:t=>{x.uniforms.c1=M(t,.8,1)}},{dif_hue:[.66,0,1,.01],onChange:t=>{x.uniforms.c2=M(t,.9,1)}},{scale:[3.7,1,10,.01],onChange:t=>{x.uniforms.amp=t}},{time:[.18,.1,1,.01],onChange:t=>{x.uniforms.tscale=t}},{alpha:[.64,0,1,.01],onChange:t=>{x.uniforms.alpha=1-t}}]}},_=x;const b=[{v:[[0,.3809388,-.14550559999999998,1],[.25079440000000003,.40579400000000004,0,1],[0,.25079440000000003,-.40579400000000004,1],[-.25079440000000003,.40579400000000004,0,1],[0,.25079440000000003,.40579400000000004,1],[.2354332,.2354332,.2354332,1],[-.2354332,.2354332,.2354332,1],[0,.3809388,.14550559999999998,1],[0,-.3809388,-.14550559999999998,1],[0,-.25079440000000003,-.40579400000000004,1],[.25079440000000003,-.40579400000000004,0,1],[-.25079440000000003,-.40579400000000004,0,1],[0,-.3809388,.14550559999999998,1],[0,-.25079440000000003,.40579400000000004,1],[.2354332,-.2354332,.2354332,1],[.2354332,.2354332,-.2354332,1],[.40579400000000004,0,-.25079440000000003,1],[.14550559999999998,0,-.3809388,1],[.3809388,.14550559999999998,0,1],[.40579400000000004,0,.25079440000000003,1],[.2354332,-.2354332,-.2354332,1],[-.14550559999999998,0,-.3809388,1],[-.40579400000000004,0,-.25079440000000003,1],[.3809388,-.14550559999999998,0,1],[-.40579400000000004,0,.25079440000000003,1],[-.2354332,.2354332,-.2354332,1],[.14550559999999998,0,.3809388,1],[-.3809388,.14550559999999998,0,1],[-.2354332,-.2354332,-.2354332,1],[-.14550559999999998,0,.3809388,1],[-.3809388,-.14550559999999998,0,1],[-.2354332,-.2354332,.2354332,1]],i:[[0,1],[1,2],[0,2],[0,3],[2,3],[1,3],[4,5],[1,5],[1,4],[3,4],[3,6],[4,6],[1,7],[3,7],[4,7],[8,9],[9,10],[8,10],[8,11],[10,11],[9,11],[11,12],[10,12],[11,13],[12,13],[10,13],[10,14],[13,14],[2,15],[1,15],[1,16],[15,16],[2,16],[9,17],[2,9],[2,17],[16,17],[9,16],[16,18],[1,18],[14,19],[10,19],[5,19],[4,19],[13,19],[1,19],[18,19],[16,19],[10,20],[9,20],[16,20],[10,16],[21,22],[2,22],[2,21],[9,21],[9,22],[10,23],[16,23],[19,23],[6,24],[3,24],[4,24],[2,25],[22,25],[3,25],[3,22],[4,26],[4,13],[13,26],[19,26],[3,27],[22,27],[22,24],[24,27],[9,28],[11,28],[22,28],[11,22],[13,29],[4,29],[24,29],[13,24],[22,30],[11,30],[24,30],[11,24],[11,31],[13,31],[24,31]]},{v:[[-.254559,.254559,.254559,1],[-.509117,0,0,1],[0,0,.509117,1],[0,.509117,0,1],[.254559,.254559,-.254559,1],[0,0,-.509117,1],[0,-.509117,0,1],[.254559,-.254559,.254559,1],[-.254559,-.254559,.254559,1],[-.254559,-.254559,-.254559,1],[-.254559,.254559,-.254559,1],[.509117,0,0,1],[.254559,-.254559,-.254559,1],[.254559,.254559,.254559,1]],i:[[1,8],[1,9],[6,9],[6,8],[0,3],[0,2],[2,13],[3,13],[4,11],[3,4],[11,13],[0,1],[2,8],[2,7],[7,11],[1,10],[5,10],[5,9],[5,12],[6,12],[6,7],[11,12],[4,5],[3,10]]},{v:[[.118034,.309017,0,1],[.5,.309017,0,1],[.190983,.190983,-.190983,1],[.118034,-.309017,0,1],[.5,-.309017,0,1],[.190983,-.190983,.190983,1],[-.118034,-.309017,0,1],[-.5,-.309017,0,1],[-.190983,-.190983,-.190983,1],[-.118034,.309017,0,1],[-.5,.309017,0,1],[-.190983,.190983,.190983,1],[0,.118034,-.309017,1],[0,.5,-.309017,1],[0,-.118034,.309017,1],[0,-.5,.309017,1],[0,-.118034,-.309017,1],[0,-.5,-.309017,1],[0,.118034,.309017,1],[0,.5,.309017,1],[.309017,0,-.118034,1],[.309017,0,-.5,1],[.309017,0,.118034,1],[.309017,0,.5,1],[-.309017,0,-.118034,1],[-.309017,0,-.5,1],[-.309017,0,.118034,1],[-.309017,0,.5,1],[.190983,.190983,.190983,1],[.190983,-.190983,-.190983,1],[-.190983,-.190983,.190983,1],[-.190983,.190983,-.190983,1]],i:[[0,1],[1,2],[0,2],[3,4],[4,5],[3,5],[6,7],[7,8],[6,8],[9,10],[10,11],[9,11],[12,13],[2,13],[2,12],[14,15],[5,15],[5,14],[16,17],[8,17],[8,16],[18,19],[11,19],[11,18],[20,21],[2,21],[2,20],[22,23],[5,23],[5,22],[24,25],[8,25],[8,24],[26,27],[11,27],[11,26],[1,28],[0,28],[4,29],[3,29],[7,30],[6,30],[10,31],[9,31],[13,31],[12,31],[15,30],[14,30],[17,29],[16,29],[19,28],[18,28],[21,29],[20,29],[23,28],[22,28],[25,31],[24,31],[27,30],[26,30],[1,22],[4,20],[7,26],[10,24],[9,19],[0,19],[0,9],[6,17],[3,17],[3,6],[3,15],[6,15],[0,13],[9,13],[16,25],[12,25],[12,16],[18,27],[14,27],[14,18],[12,21],[16,21],[14,23],[18,23],[4,22],[20,22],[1,20],[10,26],[24,26],[7,24]]},{v:[[-.3299833333333333,.3299833333333333,0,1],[-.3299833333333333,-.3299833333333333,0,1],[-.3299833333333333,0,.3299833333333333,1],[0,.3299833333333333,.3299833333333333,1],[0,.3299833333333333,-.3299833333333333,1],[0,-.3299833333333333,.3299833333333333,1],[0,-.3299833333333333,-.3299833333333333,1],[.3299833333333333,0,-.3299833333333333,1],[.3299833333333333,.3299833333333333,0,1],[-.3299833333333333,0,-.3299833333333333,1],[.3299833333333333,-.3299833333333333,0,1],[.3299833333333333,0,.3299833333333333,1]],i:[[2,3],[0,3],[0,2],[2,5],[5,11],[3,11],[6,7],[6,9],[4,9],[4,7],[1,2],[1,5],[0,9],[1,9],[7,10],[7,8],[8,11],[10,11],[4,8],[1,6],[0,4],[3,8],[6,10],[5,10]]},{v:[[.392099,.1414175,-.2184655,1],[.2587655,-.1252495,-.351799,1],[.1254325,.274751,-.351799,1],[-.1412345,-.2585825,-.351799,1],[-.2745675,.1414175,-.351799,1],[.2587655,.408084,-.085132,1],[-.407901,-.125249,-.218466,1],[-.2745675,-.391916,-.0851325,1],[.392099,-.258583,-.085132,1],[.2587655,-.391916,.181534,1],[.125432,-.391916,-.218466,1],[-.007901,-.3252495,-.2851325,1],[-.1412345,.408084,-.2184655,1],[.392099,.2747505,.1815345,1],[.1254325,-.258583,.448201,1],[.2587655,.1414175,.448201,1],[-.1412345,.2747505,.448201,1],[-.2745675,-.1252495,.448201,1],[-.274568,.408084,.1815345,1],[-.407901,.2747505,-.085132,1],[.125432,.408084,.314868,1],[-.1412345,-.391916,.3148675,1],[.392099,-.1252495,.314868,1],[-.407901,-.258583,.181534,1],[-.407901,.141417,.314868,1]],i:[[0,1],[1,2],[0,2],[1,3],[3,4],[2,4],[0,5],[2,5],[4,6],[3,6],[6,7],[3,7],[8,9],[9,10],[8,10],[10,11],[3,11],[1,10],[7,10],[2,12],[4,12],[0,13],[5,13],[5,12],[14,15],[15,16],[16,17],[14,17],[12,18],[12,19],[18,19],[16,18],[16,20],[18,20],[9,14],[14,21],[9,21],[9,22],[14,22],[7,21],[21,23],[7,23],[5,20],[6,23],[6,19],[4,19],[23,24],[19,24],[17,23],[17,24],[17,21],[16,24],[18,24],[15,20],[13,20],[13,15],[15,22],[0,8],[1,8],[8,22],[13,22]]},{v:[[-.14046272727272727,.36773545454545453,-.22727272727272727,1],[.14046272727272727,.36773545454545453,-.22727272727272727,1],[-.22727272727272727,.14046272727272727,-.36773545454545453,1],[0,.45454545454545453,0,1],[.14046272727272727,.36773545454545453,.22727272727272727,1],[-.14046272727272727,.36773545454545453,.22727272727272727,1],[0,0,.45454545454545453,1],[.023993636363636363,-.2660954545454545,-.36773545454545453,1],[.3917290909090909,-.03882272727272727,-.22727272727272727,1],[.2660954545454545,-.2900890909090909,-.22727272727272727,1],[.03882272727272727,-.43055181818181815,-.14046272727272727,1],[.03882272727272727,-.43055181818181815,.14046272727272727,1],[-.2032790909090909,-.4065581818181818,0,1],[0,0,-.45454545454545453,1],[.22727272727272727,.14046272727272727,-.36773545454545453,1],[.36773545454545453,.22727272727272727,-.14046272727272727,1],[.3917290909090909,-.03882272727272727,.22727272727272727,1],[.36773545454545453,.22727272727272727,.14046272727272727,1],[.4065581818181818,-.2032790909090909,0,1],[-.22727272727272727,-.14046272727272727,-.36773545454545453,1],[-.45454545454545453,0,0,1],[.2660954545454545,-.2900890909090909,.22727272727272727,1],[.22727272727272727,.14046272727272727,.36773545454545453,1],[-.36773545454545453,.22727272727272727,-.14046272727272727,1],[.023993636363636363,-.2660954545454545,.36773545454545453,1],[-.36773545454545453,.22727272727272727,.14046272727272727,1],[-.22727272727272727,.14046272727272727,.36773545454545453,1],[-.36773545454545453,-.22727272727272727,-.14046272727272727,1],[-.22727272727272727,-.14046272727272727,.36773545454545453,1],[-.36773545454545453,-.22727272727272727,.14046272727272727,1]],i:[[0,3],[1,3],[0,1],[4,5],[3,4],[3,5],[7,9],[9,10],[7,10],[10,12],[10,11],[11,12],[1,14],[13,14],[2,13],[0,2],[2,19],[19,27],[20,27],[20,23],[2,23],[8,15],[8,14],[14,15],[1,15],[15,17],[16,17],[16,18],[8,18],[9,18],[8,9],[7,13],[13,19],[7,19],[16,21],[16,22],[6,22],[6,24],[21,24],[18,21],[17,22],[4,17],[4,22],[25,26],[20,25],[20,29],[28,29],[26,28],[0,23],[11,24],[11,21],[5,26],[6,26],[23,25],[5,25],[24,28],[12,29],[6,28],[27,29],[12,27]]}],{sin:Y,cos:A,floor:z,abs:P,sqrt:C,PI:E}=Math;function S(t,e){let n=[];for(let r=0;r<t.length;r++)n.push([t[r][0]*e[0][0]+t[r][1]*e[1][0]+t[r][2]*e[2][0]+t[r][3]*e[3][0],t[r][0]*e[0][1]+t[r][1]*e[1][1]+t[r][2]*e[2][1]+t[r][3]*e[3][1],t[r][0]*e[0][2]+t[r][1]*e[1][2]+t[r][2]*e[2][2]+t[r][3]*e[3][2],t[r][0]*e[0][3]+t[r][1]*e[1][3]+t[r][2]*e[2][3]+t[r][3]*e[3][3]]);return n}function N(t,e){let n=[];for(let r=0;r<t.length;r++){let i=t[r][0]*e[0][0]+t[r][1]*e[1][0]+t[r][2]*e[2][0]+t[r][3]*e[3][0],o=t[r][0]*e[0][1]+t[r][1]*e[1][1]+t[r][2]*e[2][1]+t[r][3]*e[3][1],a=t[r][0]*e[0][2]+t[r][1]*e[1][2]+t[r][2]*e[2][2]+t[r][3]*e[3][2],s=t[r][0]*e[0][3]+t[r][1]*e[1][3]+t[r][2]*e[2][3]+t[r][3]*e[3][3];n.push([i/s,o/s,a/s,s])}return n}function R(t,e){return[t[0]-e[0],t[1]-e[1],t[2]-e[2],1]}function O(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0],1]}function Z(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function T(t){let e=C(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);return[t[0]/e,t[1]/e,t[2]/e,t[3]||1]}function I(t,e,n){let r=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],i=[[A(n),-Y(n),0,0],[Y(n),A(n),0,0],[0,0,1,0],[0,0,0,1]],o=[[1,0,0,0],[0,A(t),-Y(t),0],[0,Y(t),A(t),0],[0,0,0,1]],a=[[A(e),0,Y(e),0],[0,1,0,0],[-Y(e),0,A(e),0],[0,0,0,1]];return r=S(r,i),r=S(r,a),r=S(r,o),r}function L(t,e,n,r,i,o,a){t.beginPath(),t.moveTo(r*e*.5+.5*e,i*n*.5+.5*n),t.lineTo(o*e*.5+.5*e,a*n*.5+.5*n),t.closePath(),t.stroke()}function k(t,e){for(let e of t.models){let n=e.r_mat?S(e.vertices,e.r_mat):e.vertices;n=e.t_mat?S(n,e.t_mat):n,e.v_mat&&(n=S(n,e.v_mat)),t.p_mat&&(n=N(n,t.p_mat));for(let r of e.elements){let e=r.length;if(2==e){let e=r[0],i=r[1];Math.max(n[e][2],n[i][2])<t.z_clip&&L(t.ctx,t.x,t.y,n[e][0],n[e][1],n[i][0],n[i][1])}else if(e>2)for(let i=0;i<e;i++){let o=r[i],a=r[(i+1)%e];L(t.ctx,t.x,t.y,n[o][0],n[o][1],n[a][0],n[a][1])}}}}const{cos:W,sin:q,sqrt:j,min:B,max:U,floor:V,round:D,random:H,PI:G}=Math;var $,J,K,Q,tt,et,nt,rt,it,ot,at,st=0,lt=0,ht=-.2,ut=-.15,ft=-.12,ct=G,Ft=0;const mt=[{scale:1.4,z:-.69,clip:-.12},{scale:1.3,z:-.57,clip:5},{scale:1.4,z:-.45,clip:-.97},{scale:1.4,z:-.68,clip:1},{scale:.9,z:-.85,clip:.73},{scale:1.1,z:-.72,clip:-.12}];var dt="rgb(255,0,0,1)",pt={id:null,level:null};function vt(t){if(pt.id!=t.id){pt.id=t.id,t&&t.map_callbacks.geom_poly&&(Ft=t.map_callbacks.geom_poly(t)),tt=b[Ft];let e=mt[Ft];et=I(ht*ct,ut*ct,ft*ct),(rt=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]])[3][2]=e.z,nt=function(t,e,n){return[[t,0,0,0],[0,t,0,0],[0,0,t,-e],[0,0,0,n]]}(e.scale,.5,.3),it=function(t,e,n){let r=T(R(t,e)),i=T(O(r,[0,1,0])),o=O(i,r);return[[i[0],i[1],i[2],0],[o[0],o[1],o[2],0],[r[0],r[1],r[2],0],[-Z(i,t),-Z(o,t),-(1-n)-Z(r,t)*n,1]]}([1*st,1*lt,-1],[0,0,.1],0),ot=function(t,e,n,r,i,o){return{colors:t,vertices:e,elements:n,r_mat:r,t_mat:i,v_mat:o}}(0,tt.v,tt.i,et,rt,it),at=function(t,e,n,r,i,o){return{ctx:t,x:e,y:n,models:r instanceof Array?r:[r],v_mat:i,p_mat:o,z_clip:5}}($,J,K,ot,null,nt),at.z_clip=e.clip}}const gt={setup:function(t){$=t.ctx,J=t.w,K=t.h,vt(Q=t.params),dt=Q.line_g.stroke||dt,$.strokeStyle=dt},draw:function(t){vt(Q=t.params),dt=Q.line_g.stroke,$.strokeStyle=dt,k(at)},loop:function(t){let e=at.models[0],n=I(.04*ht,.04*ut,.04*ft);e.vertices=S(e.vertices,n),$.strokeStyle=dt,k(at)},unloop:function(){},gui:null},wt=gt,{sin:yt,cos:Xt,floor:Mt,abs:xt,sqrt:_t,PI:bt}=Math,Yt={axiom:"X",theta:24,delta:5,F:"FF",X:"F-[[X]+X]+F[+FX]-X"},At={geom:[],stack:[],delta:8,theta:.5*bt,pos:[0,0,0,1],dir:[0,-1,0,1]},zt={F:t=>{let e=[t.pos];t.pos=Ot(t.pos,Zt(t.dir,t.delta)),e.push(t.pos),t.geom.push(e)},f:t=>{t.pos=Ot(t.pos,Zt(t.dir,t.delta))},"-":t=>{t.dir=Rt(t.dir,Nt(t.theta))},"+":t=>{t.dir=Rt(t.dir,Nt(-t.theta))},"&":t=>{t.dir=Rt(t.dir,Et(t.theta))},"^":t=>{t.dir=Rt(t.dir,Et(-t.theta))},"\\":t=>{t.dir=Rt(t.dir,St(t.theta))},"/":t=>{t.dir=Rt(t.dir,St(-t.theta))},"|":t=>{t.dir=Rt(t.dir,Nt(bt))},"[":t=>{t.stack.push({pos:t.pos,dir:t.dir})},"]":t=>{let e=t.stack.pop();e&&(t.pos=e.pos,t.dir=e.dir)}};function Pt(t,e,n){let r=t.axiom,i=n?(o=n,function(){var t=o+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296}):Math.random;var o;for(let n=0;n<e;n++){let e="";for(let n of r){let r=null;r=t[n]instanceof Array?t[n][Math.round(i()*(t[n].length-1))]:t[n],e+=null==r?n:r}r=e}return r}function Ct(t,e=3,n,r=0,i=400,o=400){At.geom=[],At.stack=[],function(t,e,n,r=0){t.pos=[0,0,0,1],t.dir=[0,-1,0,1],t.geom=[],t.stack=[],0==n&&(n=e.n?e.n:3);let i=Pt(e,n,r);e.theta&&(t.theta=e.theta*(bt/180)),e.delta&&(t.delta=e.delta);for(let e of i)zt[e]&&zt[e](t)}(At,t||Yt,e,r);let a=function(t){let e=[],n=[],r=0;for(let i of t)e.push(...i),n.push([r++,r++]);return{v:e,i:n}}(At.geom);return function(t,e,n,r=!0){let i=0,o=0,a=0;for(let r=0;r<t.length;r++)t[r]=(s=t[r],l=e,h=n,[(2*s[0]-l)/h,(2*s[1]-h)/h,(2*s[2]-h)/h,1]),i+=t[r][0],o+=t[r][1],a+=t[r][2];var s,l,h;i/=t.length,o/=t.length,a/=t.length,r||(i=o=a=-1);for(let e=0;e<t.length;e++)t[e][0]-=i,t[e][1]-=o,t[e][2]-=a}(a.v,i,o,n),a}function Et(t){return[[1,0,0,0],[0,Xt(t),-yt(t),0],[0,yt(t),Xt(t),0],[0,0,0,1]]}function St(t){return[[Xt(t),0,yt(t),0],[0,1,0,0],[-yt(t),0,Xt(t),0],[0,0,0,1]]}function Nt(t){return[[Xt(t),-yt(t),0,0],[yt(t),Xt(t),0,0],[0,0,1,0],[0,0,0,1]]}function Rt(t,e){return[t[0]*e[0][0]+t[1]*e[1][0]+t[2]*e[2][0]+t[3]*e[3][0],t[0]*e[0][1]+t[1]*e[1][1]+t[2]*e[2][1]+t[3]*e[3][1],t[0]*e[0][2]+t[1]*e[1][2]+t[2]*e[2][2]+t[3]*e[3][2],t[0]*e[0][3]+t[1]*e[1][3]+t[2]*e[2][3]+t[3]*e[3][3]]}function Ot(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2],1]}function Zt(t,e){return[t[0]*e,t[1]*e,t[2]*e,1]}const Tt=[{axiom:"F",theta:60,delta:4,n:5,F:["FF-[XY]+[XY]","FYF-[XY]+[--XY]"],X:"+F+--X+Y",Y:"-FX"},{theta:45,delta:10,n:3,axiom:"+WF--YF--ZF",W:"YF++ZF----XF[-YF----WF]++",X:"+YF--ZF[---WF--XF]+",Y:["-WF++XF[+++YF++ZF]-","+XF[YFZF]-","XX-F"],Z:"--YF++++WF[+ZF++++XF]--XF",F:"FF"},{theta:36,delta:10,n:2,axiom:"+WF--XF---YF--ZF",F:"FF",W:["YF++ZF----XF[+++]++","YF++ZF----XF[-YF----WF]++"],X:"+YF--ZF[---WF--XF]+",Y:["-WF++XF[+++YF++ZF]-","-XY[F++F]"],Z:"--YF++++WF[+ZF++++XF]--XF"},{theta:45,delta:6,n:3,axiom:"F",F:["F[+FF]F[-FF]F","FF[+FF]F[-FFF]","F[+FFF]Z[-FF]F","F[+FFF]Z[-FF]F"],Z:["","-","F[ZF]-"]},{theta:36,delta:20,n:3,axiom:"+WF--XF---YF--ZF",F:"",W:["YF++ZF----XF[-YF----WF]++","YFXF[-YF----WF]++"],X:["+YF--ZF[---WF--XF]+"],Y:["-WF++XF[+++YF++ZF]-","--W++F[YF+++ZF]-"],Z:["--YF++++WF[+ZF++++XF]--XF","-YF++++F-XF"]},{theta:20,delta:12,n:3,axiom:"FXFXFX",F:"",X:["[FX-FY][-FX-FY-FX][ZZ]-FY-FX+FY+FX","[FX-FY]-FF+FY+FX"],Y:"FY",Z:"-FX-FY-FX"},{axiom:"X",theta:24,delta:5,n:4,F:["FF","FF","XF","+FXF"],X:["F-[[X]+X]+F[+FX]-X","F-[[-X]+X]+[F[+FX]-]FXX","F-[-F[-X]F+X]+F[+FX]-X"]},{axiom:"F",theta:60,delta:5,n:5,F:["FF-[XY]+[XY]","FF-[YY]+[Y-XY]"],X:["+FY","F+XY","-F+FXY"],Y:["-X","-XF-X"]},{axiom:"F",theta:30,delta:5,n:5,F:["FF-[FY]+[XY]","FF-[FF+Y]+[XY]","F-[FY]+[F+XY]"],X:["+FX--Y","X-Y","X[F]-Y--F"],Y:["XX","-XYX","-Y-FX"]},{axiom:"X+F",theta:45,delta:6,n:4,F:["+X-F","-XX+F","+XF+"],X:["-FFXF[X+FF-F+]","-FF[X+XX]-F","FXF[X+[F-]XF+]"]},{axiom:"F+F+F+F",theta:90,delta:8,n:2,F:["F+F-F-FF+F+F-F","F--FF-F-FF+F+F-F","F--FF-F-F+F+F+F-F","F+F-FF+F-FF+F+F"]},{axiom:"F",theta:28,delta:9,n:3,F:["[FF+[+F-F-F]X-[-F+F+F]","[FF+[+F-FF]-[FX+F+F]","F[F[FF]+F]"],X:["X[F-X]","-X+XF","[F++]-XF","+XXF"]},{theta:60,delta:10,n:3,axiom:"+WF--XF---YF--ZF",F:"FF",W:["YF++ZF----XF[+++]++","YF++ZF----XF[-YF----WF]++"],X:"+YF--ZF[---WF--XF]+",Y:["-WF++XF[+++YF++ZF]-","-XY[F++F]"],Z:"--YF++++WF[+ZF++++XF]--XF"},{theta:45,delta:14,n:3,axiom:"[N]++[N]++[N]++[N]++[N]",M:["OF++PF----NF[-OF----MF]++","OF++PF-NF[-OF----MF]++"],N:"+OF--PF[---MF--NF]+",O:["-MF++NF[+++OF++PF]-","M+NF-"],P:"--OF++++MF[+PF++++NF]--NF",F:["","FF","M"]}];function It(t,e){var n=Math.abs(t),r=Math.abs(e);return 0===t?Math.log(r):0===e?Math.log(n):n<3e3&&r<3e3?.5*Math.log(t*t+e*e):(t/=2,e/=2,.5*Math.log(t*t+e*e)+Math.LN2)}var Lt={w:1,x:0,y:0,z:0};function kt(t,e,n,r,i){if(void 0!==i)return t.w=e,t.x=n,t.y=r,void(t.z=i);if("object"==typeof e&&void 0===r){if("w"in e||"x"in e||"y"in e||"z"in e)return t.w=e.w||0,t.x=e.x||0,t.y=e.y||0,void(t.z=e.z||0);if("re"in e&&"im"in e)return t.w=e.re,t.x=e.im,t.y=0,void(t.z=0);if(4===e.length)return t.w=e[0],t.x=e[1],t.y=e[2],void(t.z=e[3]);if(3===e.length)return t.w=0,t.x=e[0],t.y=e[1],void(t.z=e[2]);throw new Error("Invalid object")}if("string"!=typeof e||void 0!==r)void 0===e&&t!==Lt?(t.w=1,t.x=t.y=t.z=0):(t.w=e||0,n&&3===n.length?(t.x=n[0],t.y=n[1],t.z=n[2]):(t.x=n||0,t.y=r||0,t.z=i||0));else{var o=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),a=1,s=0,l={i:"x",j:"y",k:"z"};if(null===o)throw new Error("Parse error");t.w=t.x=t.y=t.z=0;for(var h=0;h<o.length;h++){var u=o[h],f=o[h+1];if(" "===u||"\t"===u||"\n"===u);else if("+"===u)a++;else if("-"===u)s++;else{if(a+s===0)throw new Error("Parse error"+u);var c=l[u];if(void 0!==c)" "===f||isNaN(f)?u="1":(u=f,h++);else{if(isNaN(u))throw new Error("Parser error");void 0!==(c=l[f])&&h++}t[c||"w"]+=parseFloat((s%2?"-":"")+u),a=s=0}}if(a+s>0)throw new Error("Parser error")}}function Wt(t,e,n){var r="";return 0!==t&&(""!==n?r+=t<0?" - ":" + ":t<0&&(r+="-"),1===(t=Math.abs(t))&&""!==e||(r+=t),r+=e),r}function qt(t,e,n,r){if(!(this instanceof qt))return new qt(t,e,n,r);kt(this,t,e,n,r)}qt.prototype={w:1,x:0,y:0,z:0,add:function(t,e,n,r){return kt(Lt,t,e,n,r),new qt(this.w+Lt.w,this.x+Lt.x,this.y+Lt.y,this.z+Lt.z)},sub:function(t,e,n,r){return kt(Lt,t,e,n,r),new qt(this.w-Lt.w,this.x-Lt.x,this.y-Lt.y,this.z-Lt.z)},neg:function(){return new qt(-this.w,-this.x,-this.y,-this.z)},norm:function(){var t=this.w,e=this.x,n=this.y,r=this.z;return Math.sqrt(t*t+e*e+n*n+r*r)},normSq:function(){var t=this.w,e=this.x,n=this.y,r=this.z;return t*t+e*e+n*n+r*r},normalize:function(){var t=this.w,e=this.x,n=this.y,r=this.z,i=Math.sqrt(t*t+e*e+n*n+r*r);return i<qt.EPSILON?qt.ZERO:new qt(t*(i=1/i),e*i,n*i,r*i)},mul:function(t,e,n,r){kt(Lt,t,e,n,r);var i=this.w,o=this.x,a=this.y,s=this.z,l=Lt.w,h=Lt.x,u=Lt.y,f=Lt.z;return new qt(i*l-o*h-a*u-s*f,i*h+o*l+a*f-s*u,i*u+a*l+s*h-o*f,i*f+s*l+o*u-a*h)},scale:function(t){return new qt(this.w*t,this.x*t,this.y*t,this.z*t)},dot:function(t,e,n,r){return kt(Lt,t,e,n,r),this.w*Lt.w+this.x*Lt.x+this.y*Lt.y+this.z*Lt.z},inverse:function(){var t=this.w,e=this.x,n=this.y,r=this.z,i=t*t+e*e+n*n+r*r;return 0===i?qt.ZERO:new qt(t*(i=1/i),-e*i,-n*i,-r*i)},div:function(t,e,n,r){kt(Lt,t,e,n,r);var i=this.w,o=this.x,a=this.y,s=this.z,l=Lt.w,h=Lt.x,u=Lt.y,f=Lt.z,c=l*l+h*h+u*u+f*f;return 0===c?qt.ZERO:new qt((i*l+o*h+a*u+s*f)*(c=1/c),(o*l-i*h-a*f+s*u)*c,(a*l-i*u-s*h+o*f)*c,(s*l-i*f-o*u+a*h)*c)},conjugate:function(){return new qt(this.w,-this.x,-this.y,-this.z)},exp:function(){var t=this.w,e=this.x,n=this.y,r=this.z,i=Math.sqrt(e*e+n*n+r*r),o=Math.exp(t),a=o/i*Math.sin(i);return 0===i?new qt(o,0,0,0):new qt(o*Math.cos(i),e*a,n*a,r*a)},log:function(){var t=this.w,e=this.x,n=this.y,r=this.z;if(0===n&&0===r)return new qt(It(t,e),Math.atan2(e,t),0,0);var i=e*e+n*n+r*r+t*t,o=Math.sqrt(e*e+n*n+r*r),a=Math.atan2(o,t)/o;return new qt(.5*Math.log(i),e*a,n*a,r*a)},pow:function(t,e,n,r){if(kt(Lt,t,e,n,r),0===Lt.y&&0===Lt.z){if(1===Lt.w&&0===Lt.x)return this;if(0===Lt.w&&0===Lt.x)return qt.ONE;if(0===this.y&&0===this.z){var i=this.w,o=this.x;if(0===i&&0===o)return qt.ZERO;var a=Math.atan2(o,i),s=It(i,o);if(0===Lt.x){if(0===o&&i>=0)return new qt(Math.pow(i,Lt.w),0,0,0);if(0===i)switch(Lt.w%4){case 0:return new qt(Math.pow(o,Lt.w),0,0,0);case 1:return new qt(0,Math.pow(o,Lt.w),0,0);case 2:return new qt(-Math.pow(o,Lt.w),0,0,0);case 3:return new qt(0,-Math.pow(o,Lt.w),0,0)}}return i=Math.exp(Lt.w*s-Lt.x*a),o=Lt.x*s+Lt.w*a,new qt(i*Math.cos(o),i*Math.sin(o),0,0)}}return this.log().mul(Lt).exp()},equals:function(t,e,n,r){kt(Lt,t,e,n,r);var i=qt.EPSILON;return Math.abs(Lt.w-this.w)<i&&Math.abs(Lt.x-this.x)<i&&Math.abs(Lt.y-this.y)<i&&Math.abs(Lt.z-this.z)<i},isFinite:function(){return isFinite(this.w)&&isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)},isNaN:function(){return isNaN(this.w)||isNaN(this.x)||isNaN(this.y)||isNaN(this.z)},toString:function(){var t=this.w,e=this.x,n=this.y,r=this.z,i="";return isNaN(t)||isNaN(e)||isNaN(n)||isNaN(r)?"NaN":(i=Wt(t,"",i),i+=Wt(e,"i",i),i+=Wt(n,"j",i),""===(i+=Wt(r,"k",i))?"0":i)},real:function(){return this.w},imag:function(){return[this.x,this.y,this.z]},toVector:function(){return[this.w,this.x,this.y,this.z]},toMatrix:function(t){var e=this.w,n=this.x,r=this.y,i=this.z,o=e*n,a=e*r,s=e*i,l=n*n,h=n*r,u=n*i,f=r*r,c=r*i,F=i*i;return t?[[1-2*(f+F),2*(h-s),2*(u+a)],[2*(h+s),1-2*(l+F),2*(c-o)],[2*(u-a),2*(c+o),1-2*(l+f)]]:[1-2*(f+F),2*(h-s),2*(u+a),2*(h+s),1-2*(l+F),2*(c-o),2*(u-a),2*(c+o),1-2*(l+f)]},toMatrix4:function(t){var e=this.w,n=this.x,r=this.y,i=this.z,o=e*n,a=e*r,s=e*i,l=n*n,h=n*r,u=n*i,f=r*r,c=r*i,F=i*i;return t?[[1-2*(f+F),2*(h-s),2*(u+a),0],[2*(h+s),1-2*(l+F),2*(c-o),0],[2*(u-a),2*(c+o),1-2*(l+f),0],[0,0,0,1]]:[1-2*(f+F),2*(h-s),2*(u+a),0,2*(h+s),1-2*(l+F),2*(c-o),0,2*(u-a),2*(c+o),1-2*(l+f),0,0,0,0,1]},toEuler:function(){var t=this.w,e=this.x,n=this.y,r=this.z,i=2*(t*n-r*e);return{roll:Math.atan2(2*(t*e+n*r),1-2*(e*e+n*n)),pitch:i>=1?Math.PI/2:i<=-1?-Math.PI/2:Math.asin(i),yaw:Math.atan2(2*(t*r+e*n),1-2*(n*n+r*r))}},clone:function(){return new qt(this)},rotateVector:function(t){var e=this.w,n=this.x,r=this.y,i=this.z,o=t[0],a=t[1],s=t[2],l=2*(r*s-i*a),h=2*(i*o-n*s),u=2*(n*a-r*o);return[o+e*l+r*u-i*h,a+e*h+i*l-n*u,s+e*u+n*h-r*l]},slerp:function(t,e,n,r){kt(Lt,t,e,n,r);var i=this.w,o=this.x,a=this.y,s=this.z,l=Lt.w,h=Lt.x,u=Lt.y,f=Lt.z,c=i*l+o*h+a*u+s*f;if(c<0&&(i=-i,o=-o,a=-a,s=-s,c=-c),c>=1-qt.EPSILON)return function(t){return new qt(i+t*(l-i),o+t*(h-o),a+t*(u-a),s+t*(f-s)).normalize()};var F=Math.acos(c),m=Math.sin(F);return function(t){var e=F*t,n=Math.sin(e),r=Math.cos(e)-c*n/m,d=n/m;return new qt(r*i+d*l,r*o+d*h,r*a+d*u,r*s+d*f)}}},qt.ZERO=new qt(0,0,0,0),qt.ONE=new qt(1,0,0,0),qt.I=new qt(0,1,0,0),qt.J=new qt(0,0,1,0),qt.K=new qt(0,0,0,1),qt.EPSILON=1e-16,qt.fromAxisAngle=function(t,e){var n=.5*e,r=t[0],i=t[1],o=t[2],a=Math.sin(n),s=Math.cos(n),l=a/Math.sqrt(r*r+i*i+o*o);return new qt(s,r*l,i*l,o*l)},qt.fromBetweenVectors=function(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],l=n*o+r*a+i*s;qt.EPSILON;var h=r*s-i*a,u=i*o-n*s,f=n*a-r*o;return new qt(l+Math.sqrt(l*l+h*h+u*u+f*f),h,u,f).normalize()},qt.random=function(){var t=Math.random(),e=Math.random(),n=Math.random(),r=Math.sqrt(1-t),i=Math.sqrt(t);return new qt(i*Math.cos(2*Math.PI*n),r*Math.sin(2*Math.PI*e),r*Math.cos(2*Math.PI*e),i*Math.sin(2*Math.PI*n))},qt.fromEuler=function(t,e,n,r){var i=.5*t,o=.5*e,a=.5*n,s=Math.cos(i),l=Math.cos(o),h=Math.cos(a),u=Math.sin(i),f=Math.sin(o),c=Math.sin(a);return void 0===r||"ZXY"===r?new qt(s*l*h-u*f*c,s*h*f-l*u*c,s*l*c+h*u*f,l*h*u+s*f*c):"XYZ"===r||"RPY"===r?new qt(s*l*h-u*f*c,l*h*u+s*f*c,s*h*f-l*u*c,s*l*c+h*u*f):"YXZ"===r?new qt(s*l*h+u*f*c,s*h*f+l*u*c,l*h*u-s*f*c,s*l*c-h*u*f):"ZYX"===r||"YPR"===r?new qt(s*l*h+u*f*c,s*l*c-h*u*f,s*h*f+l*u*c,l*h*u-s*f*c):"YZX"===r?new qt(s*l*h-u*f*c,s*l*c+h*u*f,l*h*u+s*f*c,s*h*f-l*u*c):"XZY"===r?new qt(s*l*h+u*f*c,l*h*u-s*f*c,s*l*c-h*u*f,s*h*f+l*u*c):null},qt.fromMatrix=function(t){if(9===t.length)var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],l=t[7],h=t[8];else e=t[0][0],n=t[0][1],r=t[0][2],i=t[1][0],o=t[1][1],a=t[1][2],s=t[2][0],l=t[2][1],h=t[2][2];var u,f=e+o+h;return f>0?new qt(.25*(u=2*Math.sqrt(f+1)),(l-a)/u,(r-s)/u,(i-n)/u):e>o&e>h?new qt((l-a)/(u=2*Math.sqrt(1+e-o-h)),.25*u,(n+i)/u,(r+s)/u):o>h?new qt((r-s)/(u=2*Math.sqrt(1+o-e-h)),(n+i)/u,.25*u,(a+l)/u):new qt((i-n)/(u=2*Math.sqrt(1+h-e-o)),(r+s)/u,(a+l)/u,.25*u)};const jt=qt,{cos:Bt,sin:Ut,pow:Vt,sqrt:Dt,abs:Ht,sign:Gt,min:$t,max:Jt,floor:Kt,round:Qt,random:te,PI:ee}=Math;var ne,re,ie,oe,ae,se=$t((2**(3.46*.7)-1)/10,1),le=0,he=0,ue=6,fe=function(t,e){let n=2*ee/ue;for(let r=0;r<2*ee;r+=n){let n=Re(r+0);Ce(Ne(t,n),Ne(e,n),Fe)}},ce=0,Fe=!0,me=.7,de=1.4,pe=20,ve=0;var ge,we,ye,Xe="rgba(223.4, 241.5, 151.2, 1",Me={id:null,level:null};function xe(t){if(!t.params)return!1;Me.level!=t.params.level&&(Me.level=t.params.level),Me.id!=t.params.id&&(Me.id=t.params.id,ce=t.params.seed,t.params.map_callbacks.lsys_rule&&(le=t.params.map_callbacks.lsys_rule(t.params),ae=Pe())),t.params.map_callbacks.lsys_rot&&(ue=t.params.map_callbacks.lsys_rot(t.params)),Xe=t.params.line_l.stroke,se=t.params.ease_level;let e=t.params.norm_level,n=function(t,e){let n=.1;for(let r=Jt(Kt(t.i.length*e),1)-1;r>0;r--){let e=t.v[t.i[r][1]];n=Jt(n,e[0]**2+e[1]**2)}return Dt(n)}(ae,se);return me=.7*(.33*_e(se,1,0,.4)+.6*_e(e,.2,.8,.4)/n),!0}function _e(t,e=0,n=1,r=0){let i=Jt($t((t-e)/(n-e),1),0);return(1-r)*(3*i**2-2*i**3)+r}var be=[0,0,1],Ye=0,Ae=1,ze=0;function Pe(){return Ct(Tt[le],he,!1,ce)}function Ce(t,e,n){Se(ne,re,ie,t[0],t[1],e[0],e[1]),n&&Se(ne,re,ie,-t[0],t[1],-e[0],e[1])}function Ee(t,e,n,r){const i=Jt(Kt(e.i.length*n),1);for(let t=0;t<i;t++){let n=e.v[e.i[t][0]],i=e.v[e.i[t][1]];r?r(n,i):Ce(n,i,Fe)}}function Se(t,e,n,r,i,o,a){let s=me*de;t.beginPath(),t.moveTo(s*r*e*.5+.5*e,s*i*n*.5+.5*n),t.lineTo(s*o*e*.5+.5*e,s*a*n*.5+.5*n),t.closePath(),t.stroke()}function Ne(t,e){return[t[0]*e[0][0]+t[1]*e[1][0]+t[2]*e[2][0],t[0]*e[0][1]+t[1]*e[1][1]+t[2]*e[2][1],t[0]*e[0][2]+t[1]*e[1][2]+t[2]*e[2][2]]}function Re(t){return[[Bt(t),-Ut(t),0],[Ut(t),Bt(t),0],[0,0,1]]}const Oe={setup:function(t){ne=t.ctx,re=t.w,ie=t.h,oe=t.params,ce=oe.seed,se=oe.ease_level,ce=oe.seed,xe(t)||(ae=Pe()),ge=new jt.fromEuler(-.03,-.04,.05),we=new jt,ye=new jt},draw:function(t){xe(t),ne.strokeStyle=Xe,Ee(ne,ae,se,fe)},loop:function(){ve+=.005,ne.strokeStyle=Xe,ve>.35&&(((Ye=be[2])-Ae>0&&Ye>=.7||Ye-Ae==0)&&(ze+=.04),ze>pe&&(ze=0),be=ye.rotateVector(be),ye=ge.slerp(we)($t(ze,1)),function(t,e){for(let n=0;n<t.i.length;n++)t.v[t.i[n][0]]=e.rotateVector(t.v[t.i[n][0]]),t.v[t.i[n][1]]=e.rotateVector(t.v[t.i[n][1]])}(ae,ye),Ae=Ye),Ee(ne,ae,$t(Math.log(1+5*se)*ve,se),fe)},unloop:function(){ve=0,be=[0,0,1],Ye=0,Ae=1,ze=0,ae=Pe()},gui:{name:"l-system",open:!1,switch:!0,updateFrame:!0,fields:[{rule:[le,0,Tt.length-1,1],onChange:t=>{le=t,ae=Pe()}},{randomize:()=>{ce=99*Math.random()+1,ae=Pe(),Oe.ctl.frame()}},{amp:[de,.5,1.5,.1],onChange:t=>{de=t}},{animation_hold:[pe,1,20,.1],onChange:t=>{pe=t}}]}},Ze=Oe,Te=document.querySelector("#disp"),Ie=document.querySelector("#disp2"),Le=[600,600];var ke=null;const We=2e4,qe=!1,je={id:"",seed:0,randf:0,abs_level:0,level:0,norm_level:0,ease_level:0,level_max:We,use_overflow:qe,overflow_num:0,map_callbacks:{lsys_rot:t=>{return((e=t).randf<.5?3:4)+Math.round(2*e.ease_level);var e},lsys_rule:t=>function(t){let e=Ke(Be.arr,Be.sum,t.randf);return e}(t),geom_poly:t=>{return e=t,Ke(Ue.arr,Ue.sum,e.randf);var e}},line_l:{h:.2,s:.77,l:.72,a:1,stroke:"rgb(223.4, 241.5, 151.2, 1)"},line_g:{h:.7,s:.8,l:.56,a:1,stroke:"rgb(89, 53, 232.56, 1)"}},Be=Je([[0,1],[1,.75],[2,.66],[3,.5],[4,0],[5,.5],[6,.5],[7,.8],[8,.18],[9,.6],[10,0],[11,.5],[12,.3],[13,0]]),Ue=Je([[0,1.2],[1,1],[2,2],[3,.3],[4,.7],[5,.7]]);function Ve(t,e){Ge(je,t,null),e.params=je,e.frame()}function De(t,e){t=t||He(),Ge(je,null,t),e.params=je,e.frame(),console.log("id",je.id)}function He(){let t=Array.from("111",(t=>String.fromCharCode(93*Math.random()+33)));return encodeURIComponent(t.join("")).replace(/%/g,"")}function Ge(t,e=null,n=null){if(null!=e){let n=+e;t.abs_level=n,t.level=qe?n%We:Math.min(n,We),t.norm_level=t.level/We,t.ease_level=function(t){return Math.min((2**(3.46*t)-1)/10,1)}(t.norm_level),t.overflow_num=qe?Math.floor(n/We):0}var r;null!=n&&(t.id=n,t.seed=function(t){let e=String(t),n=0;for(let t=0,r=e.length;t<r;t++){n=(n<<5)-n+e.charCodeAt(t),n|=0}return n}(n),t.randf=t.seed?(r=t.seed,function(){var t=r+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296})():Math.random())}function $e(t){let e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);e[n]=r>=33&&r<=126?String.fromCharCode(33+(r+14)%94):String.fromCharCode(r)}return e.join("")}function Je(t){t.sort(((t,e)=>t[1]-e[1]));let e=0;for(let n=0;n<t.length;n++)e+=t[n][1],n>0&&(t[n][1]+=t[n-1][1]);return{arr:t,sum:e}}function Ke(t,e=1,n){let r=n*e;for(let e of t)if(r<=e[1])return e[0];return t.length-1}(async()=>{let t=function(){const t=new URLSearchParams(window.location.href);let e={id:t.get("id"),pgive:t.get("pgive"),level:t.get("level"),cipher:t.get("s")};e.pgive&&(e.level=e.pgive);return function(t){if(t.cipher)try{let n=(e=t.cipher,$e(decodeURIComponent(e)));const r=new URLSearchParams(n);t.id=r.get("id"),t.level=r.get("pgive")||r.get("level")}catch(t){console.log(t)}var e;return t}(e)}();Ge(je,t.level||2e3,t.id||He()),function(t,e,n){e,n,t,(ke=new p(Te,[wt,Ze],Le)).lineWidth(.5);const r={init:ke.init.bind(ke),frame:ke.frame.bind(ke),start:ke.start.bind(ke),stop:ke.stop.bind(ke),pgms:ke.pgms};new m(Ie,{chain:[X,_]},Le,0,null,null,r,t).start()}(je,Ve,De)})()})();